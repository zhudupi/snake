{"remainingRequest":"E:\\snake\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\snake\\src\\components\\myCanvas.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\snake\\src\\components\\myCanvas.vue","mtime":1589004605871},{"path":"E:\\snake\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1588920415354},{"path":"E:\\snake\\node_modules\\babel-loader\\lib\\index.js","mtime":1588920450070},{"path":"E:\\snake\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1588920415354},{"path":"E:\\snake\\node_modules\\vue-loader\\lib\\index.js","mtime":1588920442588}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tname:'myCanvas',\n\tdata(){\n\t\treturn {\n\t\t\tL:20,\n\t\t\tcontext:null,\n\t\t\tsnake:null,\n\t\t\tfood:null,\n\t\t\tT:null,\n\t\t\tspeed:1000,\n\t\t}\n\t},\n\tprops:{\n\t\t//多少排\n\t\trow:{\n\t\t\ttype:Number,\n\t\t\tdefault:32\n\t\t},\n\t\t//多少列\n\t\tcol:{\n\t\t\ttype:Number,\n\t\t\tdefault:32 \n\t\t},\n\t\tpen:{\n\t\t\ttype:String,\n\t\t\tdefault:'#000000'\n\t\t}\n\t},\n\tcomputed:{\n\t\tgrids(){\n\t\t\tlet cols=new Array()\n\t\t\tfor(let y=0;y<this.col;y++){\n\t\t\t\tlet rows=new Array()\n\t\t\t\tfor(let x=0;x<this.row;x++){\n\t\t\t\t\trows.push({\n\t\t\t\t\t\tx:x,\n\t\t\t\t\t\ty:y,\n\t\t\t\t\t\tcolor:'#ffffff',\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tcols.push(rows)\n\t\t\t}\n\t\t\treturn cols\n\t\t},\n\t\tW(){\n\t\t\treturn this.col*(this.L+1)+1\n\t\t},\n\t\tH(){\n\t\t\treturn this.row*(this.L+1)+1\n\t\t}\n\t},\n\tmounted(){\n\t\t// console.log(this.grids)\n\t\tthis.initCanvas()\n\t\t// this.initGame()\n\t\tthis.initGrids()\n\t},\n\twatch:{\n\t\tpen(){\n\t\t\tconsole.log(this.pen)\n\t\t}\n\t},\n\tmethods:{\n\t\t//初始化画布\n\t\tinitCanvas(){\n\t\t\tconst canvas=this.$refs.canvas\n\t\t\tthis.context=canvas.getContext('2d')\n\t\t\t\n\t\t},\n\t\tinitGrids(){\n\t\t\tthis.context.strokeStyle='#ccc'\n\t\t\tfor(let i=0;i<=this.row;i++){\n\t\t\t\tthis.drawLine(0,i*(this.L+1),this.col*(this.L+1),i*(this.L+1))\n\t\t\t}\n\t\t\tfor(let i=0;i<=this.col;i++){\n\t\t\t\tthis.drawLine(i*(this.L+1),0,i*(this.L+1),this.row*(this.L+1))\n\t\t\t}\n\t\t},\n\t\tdrawLine(x1,y1,x2,y2){\n\t\t\tthis.context.beginPath()\n\t\t\tthis.context.moveTo(x1,y1)\n\t\t\tthis.context.lineTo(x2,y2)\n\t\t\tthis.context.stroke()\n\t\t},\n\t\t\n\t\t\n\t\tdrawSnake:function(){\n\t\t\t// initGrids()\n\t\t\tthis.snake.body.forEach(function(e,i){\n\t\t\t\tthis.context.fillStyle=this.snake.color\n\t\t\t\tthis.context.fillRect(e.x*(this.L+1)+1,e.y*(this.L+1)+1,this.L,this.L)\n\t\t\t},this)\n\t\t},\n\t\tdrawFood:function(){\n\t\t\tthis.food.foods.forEach(function(e,i){\n\t\t\t\tthis.context.fillStyle=this.food.color\n\t\t\t\tthis.context.fillRect(e.x*(this.L+1)+1,e.y*(this.L+1)+1,this.L,this.L)\n\t\t\t},this)\n\t\t},\n\t\tdrawAll(){\n\t\t\tthis.context.clearRect(0,0,this.W,this.H)\n\t\t\tthis.initGrids()\n\t\t\tthis.drawSnake()\n\t\t\tthis.drawFood()\n\t\t},\n\t\tinitGame(){\n\t\t\tthis.snake=new Snake()\n\t\t\tthis.food=new Food({snake:this.snake})\n\t\t\t// console.log(this.food)\n\t\t\tvar that=this\n\t\t\twindow.onkeydown=function(ev){\n\t\t\t\tswitch(ev.keyCode){\n\t\t\t\t\tcase 37:\n\t\t\t\t\tif(that.snake.direction=='up'||that.snake.direction=='down'){\n\t\t\t\t\t\tthat.snake.direction='left';\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 38:\n\t\t\t\t\tif(that.snake.direction=='left'||that.snake.direction=='right'){\n\t\t\t\t\t\tthat.snake.direction='up';\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 39:\n\t\t\t\t\tif(that.snake.direction=='up'||that.snake.direction=='down'){\n\t\t\t\t\t\tthat.snake.direction='right';\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 40:\n\t\t\t\t\tif(that.snake.direction=='left'||that.snake.direction=='right'){\n\t\t\t\t\t\tthat.snake.direction='down';\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t// console.log(this.snake.body)\n\t\t\tthis.drawAll()\n\t\t\tclearTimeout(this.T)\n\t\t\tthis.T=setTimeout(this.move,this.speed)\n\t\t},\n\t\tmove(){\n\t\t\t// var eat=this.food.foods.some(e=>this.snake.body[0].x==e.x&&this.snake.body[0].y==e.y,this)\n\t\t\t// this.snake.move(!this.food.foods.some(e=>this.snake.body[0].x==e.x&&this.snake.body[0].y==e.y,this))\n\t\t\tvar that=this\n\t\t\tfunction afterEat(){\n\t\t\t\tthat.food.supFood()\n\t\t\t}\n\t\t\tthis.snake.move(this.food.foods,afterEat)\n\t\t\tif(this.snake.isDead()){\n\t\t\t\tconsole.log(this.snake.body[0])\n\t\t\t\tthis.gameOver()\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.drawAll()\n\t\t\tthis.T=setTimeout(this.move,this.speed)\n\t\t},\n\t\tgameOver(){\n\t\t\tconsole.log('game voer!')\n\t\t\t// this.initGame()\n\t\t},\n\t\tkeyDown(e){\n\t\t\tconsole.log(e)\n\t\t},\n\t\tstartGame(){\n\t\t\tthis.initGame()\n\t\t},\n\t\tstopGame(){\n\t\t\t\n\t\t\tclearTimeout(this.T)\n\t\t},\n\t\tchangeSpeed(){\n\t\t\tthis.speed=this.speed==1000?100:1000\n\t\t}\n\t\t\n\t}\n}\nfunction Coord(x,y){\n\tthis.x=x;\n\tthis.y=y\n}\nfunction Snake({initLength=4,\n\tinitHead=new Coord(0,0),\n\tgameOver=function(){\n\t\talert('game over')\n\t},\n\tw=32,\n\th=32,\n}={}){\n\tthis.L=20\n\tthis.color='#000'\n\tthis.direction='right'\n\tthis.body=[];\n\tfor(let i = 0;i<initLength;i++){\n\t\tthis.body.unshift(new Coord(initHead.x+i,initHead.y))\n\t}\n\t// this.body.reverse()\n\tthis.move=function(foods,fn){\n\t\tconst oldHead=this.body[0]\n\t\tvar dx=0,dy=0;\n\t\tswitch (this.direction){\n\t\t\tcase 'up':\n\t\t\tdx=0,dy=-1\n\t\t\tbreak;\n\t\t\tcase 'down':\n\t\t\tdx=0,dy=1;\n\t\t\tbreak;\n\t\t\tcase 'left':\n\t\t\tdx=-1,dy=0;\n\t\t\tbreak;\n\t\t\tcase 'right':\n\t\t\tdx=1,dy=0;\n\t\t\tbreak;\n\t\t}\n\t\tthis.body.unshift(new Coord(this.body[0].x+dx,this.body[0].y+dy))\n\t\tconsole.log(foods)\n\t\tif(! foods.some(e=>this.body[0].x==e.x&&this.body[0].y==e.y,this)){\n\t\t\tthis.body.pop()\n\t\t\t\n\t\t}else{\n\t\t\tfn()\n\t\t}\n\t\t// if(this.isDead()){\n\t\t// \tgameOver()\n\t\t// \treturn\n\t\t// }\n\t\t// this.draw()\n\t\t// setTimeout(this.move,1000)\n\t}\n\tthis.isDead=function(){\n\t\tconst head=this.body[0];\n\t\t//碰到墙壁\n\t\tif(head.x<0||head.x>=w||head.y<0||head.y>=h){\n\t\t\treturn true\n\t\t}\n\t\t//碰到自己\n\t\tvar flag=this.body.some(function(e,i){\n\t\t\tif(i!==0&&head.x==e.x&&head.y==e.y){\n\t\t\t\treturn true\n\t\t\t}\n\t\t})\n\t\treturn flag\n\t}\n\tthis.isEat=function(){\n\t\treturn this.food.some(e=>this.body[0].x==e.x&&this.body[0].y==e.y,this)\n\t}\n\t// this.draw=function(){\n\t// \t// initGrids()\n\t// \tthis.body.forEach(function(e,i){\n\t// \t\tctx.fillStyle=this.color\n\t// \t\tctx.fillRect(e.x*(this.L+1)+1,e.y*(this.L+1)+1,this.L,this.L)\n\t// \t},this)\n\t// }\n\t// this.draw()\n}\n\nfunction Food({\n\tnum=1,\n\tw=32,\n\th=32,\n\tsnake\n}={}){\n\tthis.foods=[]\n\tfunction genFood(){\n\t\tvar food=new Coord(Math.floor(Math.random()*w),Math.floor(Math.random()*h))\n\t\tvar flag=snake.body.some(e=>e.x==food.x&&e.y==food.y)&&arr.some(e=>e.x==food.x&&e.y==food.y)\n\t\tif(flag){\n\t\t\treturn genFood()\n\t\t}else{\n\t\t\treturn food\n\t\t}\n\t}\n\tthis.initFood=function(){\n\t\tfor(let i=0;i<num;i++){\n\t\t\tthis.foods.push(genFood())\n\t\t}\n\t}\n\tthis.initFood()\n\tthis.supFood=function(){\n\t\tthis.foods.push(genFood())\n\t\tthis.foods.pop()\n\t}\n\tthis.color='#ff0000'\n}\n",{"version":3,"sources":["myCanvas.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"myCanvas.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n\t<div class=\"fuck\">\r\n\t\t<div>\r\n\t\t\t\r\n\t\t\t<button @click=\"startGame\">开始游戏</button>\r\n\t\t\t<button @click=\"stopGame\">停止游戏</button>\r\n\t\t\t<button @click=\"changeSpeed\">当前速度{{speed}}</button>\r\n\t\t</div>\r\n\t\t<canvas id=\"canvas\" :width=\"col*(L+1)+1\" :height=\"row*(L+1)+1\" ref=\"canvas\" @keydown=\"keyDown(e)\"></canvas>\r\n\t\t<!-- <div class=\"rows\" v-for=\"(rows,y) in grids\" :key=\"y\">\r\n\t\t\t<div class=\"grid\" :style=\"'background-color:'+returnColor(x,y)\" v-for=\"(grid,x) in rows\" :key=\"x+y\" @click=\"colour(grid)\"></div>\r\n\t\t</div> -->\r\n\t</div>\n</template>\r\n\n<script>\r\n\texport default {\r\n\t\tname:'myCanvas',\r\n\t\tdata(){\r\n\t\t\treturn {\r\n\t\t\t\tL:20,\r\n\t\t\t\tcontext:null,\r\n\t\t\t\tsnake:null,\r\n\t\t\t\tfood:null,\r\n\t\t\t\tT:null,\r\n\t\t\t\tspeed:1000,\r\n\t\t\t}\r\n\t\t},\r\n\t\tprops:{\r\n\t\t\t//多少排\r\n\t\t\trow:{\r\n\t\t\t\ttype:Number,\r\n\t\t\t\tdefault:32\r\n\t\t\t},\r\n\t\t\t//多少列\r\n\t\t\tcol:{\r\n\t\t\t\ttype:Number,\r\n\t\t\t\tdefault:32 \r\n\t\t\t},\r\n\t\t\tpen:{\r\n\t\t\t\ttype:String,\r\n\t\t\t\tdefault:'#000000'\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed:{\r\n\t\t\tgrids(){\r\n\t\t\t\tlet cols=new Array()\r\n\t\t\t\tfor(let y=0;y<this.col;y++){\r\n\t\t\t\t\tlet rows=new Array()\r\n\t\t\t\t\tfor(let x=0;x<this.row;x++){\r\n\t\t\t\t\t\trows.push({\r\n\t\t\t\t\t\t\tx:x,\r\n\t\t\t\t\t\t\ty:y,\r\n\t\t\t\t\t\t\tcolor:'#ffffff',\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcols.push(rows)\r\n\t\t\t\t}\r\n\t\t\t\treturn cols\r\n\t\t\t},\r\n\t\t\tW(){\r\n\t\t\t\treturn this.col*(this.L+1)+1\r\n\t\t\t},\r\n\t\t\tH(){\r\n\t\t\t\treturn this.row*(this.L+1)+1\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted(){\r\n\t\t\t// console.log(this.grids)\r\n\t\t\tthis.initCanvas()\r\n\t\t\t// this.initGame()\r\n\t\t\tthis.initGrids()\r\n\t\t},\r\n\t\twatch:{\r\n\t\t\tpen(){\r\n\t\t\t\tconsole.log(this.pen)\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\t//初始化画布\r\n\t\t\tinitCanvas(){\r\n\t\t\t\tconst canvas=this.$refs.canvas\r\n\t\t\t\tthis.context=canvas.getContext('2d')\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tinitGrids(){\r\n\t\t\t\tthis.context.strokeStyle='#ccc'\r\n\t\t\t\tfor(let i=0;i<=this.row;i++){\r\n\t\t\t\t\tthis.drawLine(0,i*(this.L+1),this.col*(this.L+1),i*(this.L+1))\r\n\t\t\t\t}\r\n\t\t\t\tfor(let i=0;i<=this.col;i++){\r\n\t\t\t\t\tthis.drawLine(i*(this.L+1),0,i*(this.L+1),this.row*(this.L+1))\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdrawLine(x1,y1,x2,y2){\r\n\t\t\t\tthis.context.beginPath()\r\n\t\t\t\tthis.context.moveTo(x1,y1)\r\n\t\t\t\tthis.context.lineTo(x2,y2)\r\n\t\t\t\tthis.context.stroke()\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tdrawSnake:function(){\r\n\t\t\t\t// initGrids()\r\n\t\t\t\tthis.snake.body.forEach(function(e,i){\r\n\t\t\t\t\tthis.context.fillStyle=this.snake.color\r\n\t\t\t\t\tthis.context.fillRect(e.x*(this.L+1)+1,e.y*(this.L+1)+1,this.L,this.L)\r\n\t\t\t\t},this)\r\n\t\t\t},\r\n\t\t\tdrawFood:function(){\r\n\t\t\t\tthis.food.foods.forEach(function(e,i){\r\n\t\t\t\t\tthis.context.fillStyle=this.food.color\r\n\t\t\t\t\tthis.context.fillRect(e.x*(this.L+1)+1,e.y*(this.L+1)+1,this.L,this.L)\r\n\t\t\t\t},this)\r\n\t\t\t},\r\n\t\t\tdrawAll(){\r\n\t\t\t\tthis.context.clearRect(0,0,this.W,this.H)\r\n\t\t\t\tthis.initGrids()\r\n\t\t\t\tthis.drawSnake()\r\n\t\t\t\tthis.drawFood()\r\n\t\t\t},\r\n\t\t\tinitGame(){\r\n\t\t\t\tthis.snake=new Snake()\r\n\t\t\t\tthis.food=new Food({snake:this.snake})\r\n\t\t\t\t// console.log(this.food)\r\n\t\t\t\tvar that=this\r\n\t\t\t\twindow.onkeydown=function(ev){\r\n\t\t\t\t\tswitch(ev.keyCode){\r\n\t\t\t\t\t\tcase 37:\r\n\t\t\t\t\t\tif(that.snake.direction=='up'||that.snake.direction=='down'){\r\n\t\t\t\t\t\t\tthat.snake.direction='left';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 38:\r\n\t\t\t\t\t\tif(that.snake.direction=='left'||that.snake.direction=='right'){\r\n\t\t\t\t\t\t\tthat.snake.direction='up';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 39:\r\n\t\t\t\t\t\tif(that.snake.direction=='up'||that.snake.direction=='down'){\r\n\t\t\t\t\t\t\tthat.snake.direction='right';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 40:\r\n\t\t\t\t\t\tif(that.snake.direction=='left'||that.snake.direction=='right'){\r\n\t\t\t\t\t\t\tthat.snake.direction='down';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// console.log(this.snake.body)\r\n\t\t\t\tthis.drawAll()\r\n\t\t\t\tclearTimeout(this.T)\r\n\t\t\t\tthis.T=setTimeout(this.move,this.speed)\r\n\t\t\t},\r\n\t\t\tmove(){\r\n\t\t\t\t// var eat=this.food.foods.some(e=>this.snake.body[0].x==e.x&&this.snake.body[0].y==e.y,this)\r\n\t\t\t\t// this.snake.move(!this.food.foods.some(e=>this.snake.body[0].x==e.x&&this.snake.body[0].y==e.y,this))\r\n\t\t\t\tvar that=this\r\n\t\t\t\tfunction afterEat(){\r\n\t\t\t\t\tthat.food.supFood()\r\n\t\t\t\t}\r\n\t\t\t\tthis.snake.move(this.food.foods,afterEat)\r\n\t\t\t\tif(this.snake.isDead()){\r\n\t\t\t\t\tconsole.log(this.snake.body[0])\r\n\t\t\t\t\tthis.gameOver()\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tthis.drawAll()\r\n\t\t\t\tthis.T=setTimeout(this.move,this.speed)\r\n\t\t\t},\r\n\t\t\tgameOver(){\r\n\t\t\t\tconsole.log('game voer!')\r\n\t\t\t\t// this.initGame()\r\n\t\t\t},\r\n\t\t\tkeyDown(e){\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t},\r\n\t\t\tstartGame(){\r\n\t\t\t\tthis.initGame()\r\n\t\t\t},\r\n\t\t\tstopGame(){\r\n\t\t\t\t\r\n\t\t\t\tclearTimeout(this.T)\r\n\t\t\t},\r\n\t\t\tchangeSpeed(){\r\n\t\t\t\tthis.speed=this.speed==1000?100:1000\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\tfunction Coord(x,y){\r\n\t\tthis.x=x;\r\n\t\tthis.y=y\r\n\t}\r\n\tfunction Snake({initLength=4,\r\n\t\tinitHead=new Coord(0,0),\r\n\t\tgameOver=function(){\r\n\t\t\talert('game over')\r\n\t\t},\r\n\t\tw=32,\r\n\t\th=32,\r\n\t}={}){\r\n\t\tthis.L=20\r\n\t\tthis.color='#000'\r\n\t\tthis.direction='right'\r\n\t\tthis.body=[];\r\n\t\tfor(let i = 0;i<initLength;i++){\r\n\t\t\tthis.body.unshift(new Coord(initHead.x+i,initHead.y))\r\n\t\t}\r\n\t\t// this.body.reverse()\r\n\t\tthis.move=function(foods,fn){\r\n\t\t\tconst oldHead=this.body[0]\r\n\t\t\tvar dx=0,dy=0;\r\n\t\t\tswitch (this.direction){\r\n\t\t\t\tcase 'up':\r\n\t\t\t\tdx=0,dy=-1\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase 'down':\r\n\t\t\t\tdx=0,dy=1;\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase 'left':\r\n\t\t\t\tdx=-1,dy=0;\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase 'right':\r\n\t\t\t\tdx=1,dy=0;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tthis.body.unshift(new Coord(this.body[0].x+dx,this.body[0].y+dy))\r\n\t\t\tconsole.log(foods)\r\n\t\t\tif(! foods.some(e=>this.body[0].x==e.x&&this.body[0].y==e.y,this)){\r\n\t\t\t\tthis.body.pop()\r\n\t\t\t\t\r\n\t\t\t}else{\r\n\t\t\t\tfn()\r\n\t\t\t}\r\n\t\t\t// if(this.isDead()){\r\n\t\t\t// \tgameOver()\r\n\t\t\t// \treturn\r\n\t\t\t// }\r\n\t\t\t// this.draw()\r\n\t\t\t// setTimeout(this.move,1000)\r\n\t\t}\r\n\t\tthis.isDead=function(){\r\n\t\t\tconst head=this.body[0];\r\n\t\t\t//碰到墙壁\r\n\t\t\tif(head.x<0||head.x>=w||head.y<0||head.y>=h){\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\t//碰到自己\r\n\t\t\tvar flag=this.body.some(function(e,i){\r\n\t\t\t\tif(i!==0&&head.x==e.x&&head.y==e.y){\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\treturn flag\r\n\t\t}\r\n\t\tthis.isEat=function(){\r\n\t\t\treturn this.food.some(e=>this.body[0].x==e.x&&this.body[0].y==e.y,this)\r\n\t\t}\r\n\t\t// this.draw=function(){\r\n\t\t// \t// initGrids()\r\n\t\t// \tthis.body.forEach(function(e,i){\r\n\t\t// \t\tctx.fillStyle=this.color\r\n\t\t// \t\tctx.fillRect(e.x*(this.L+1)+1,e.y*(this.L+1)+1,this.L,this.L)\r\n\t\t// \t},this)\r\n\t\t// }\r\n\t\t// this.draw()\r\n\t}\r\n\t\r\n\tfunction Food({\r\n\t\tnum=1,\r\n\t\tw=32,\r\n\t\th=32,\r\n\t\tsnake\r\n\t}={}){\r\n\t\tthis.foods=[]\r\n\t\tfunction genFood(){\r\n\t\t\tvar food=new Coord(Math.floor(Math.random()*w),Math.floor(Math.random()*h))\r\n\t\t\tvar flag=snake.body.some(e=>e.x==food.x&&e.y==food.y)&&arr.some(e=>e.x==food.x&&e.y==food.y)\r\n\t\t\tif(flag){\r\n\t\t\t\treturn genFood()\r\n\t\t\t}else{\r\n\t\t\t\treturn food\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.initFood=function(){\r\n\t\t\tfor(let i=0;i<num;i++){\r\n\t\t\t\tthis.foods.push(genFood())\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.initFood()\r\n\t\tthis.supFood=function(){\r\n\t\t\tthis.foods.push(genFood())\r\n\t\t\tthis.foods.pop()\r\n\t\t}\r\n\t\tthis.color='#ff0000'\r\n\t}\n</script>\n\n<style scoped=\"scoped\">\r\n\t.rows{\r\n\t\tmargin:0;\r\n\t\tpadding:0;\r\n\t\tfont-size: 0;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\t.grid{\r\n\t\tdisplay: inline-block;\r\n\t\twidth:20px;\r\n\t\theight:20px;\r\n\t\tborder: 1px solid #ccc;\r\n\t}\r\n\t#canvas{\r\n\t\tposition: relative;\r\n\t\t/* background: #00e; */\r\n\t}\n</style>\n"]}]}